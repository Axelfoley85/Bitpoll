{% load widget_tweaks %}
{% load i18n %}

<p>This is a <b>BETA</b> feature, it is possible that it will change substantially in the future.
   Some features like editing Calendars are not implemented yet. Please give us feedback on
   the feature</p>
<p>The data provided here will be saved into the Database to retrieve the calendar on voting in Polls.
   The column is encrypted on the server side with a global key.</p>
<p>You can enter either a world readable CalDav calendar Url, or provide user and password to login to
   the CalDav Server. If you make the calendar world readable check that the url is not predictable by
   other people</p>
<h3>Add a Calendar</h3>
<form action="{% url 'change_calendar' %}" method="post">
    {% csrf_token %}
    {% if calendar_form.non_field_errors %}
        <div class="alert alert-danger">
            {% for error in calendar_form.non_field_errors %}
            {{ error }}
            {% endfor %}
        </div>
    {% endif %}
    {{ calendar_form.name.label_tag }}
    {% render_field calendar_form.name class+='form-control'%}
    {% if calendar_form.name.errors %}
        <div class="form-errors">
            <div class="alert alert-danger">
                <div class="container">
                    <i class="fa fa-times"></i>{{ calendar_form.name.errors }}
                </div>
            </div>
        </div>
    {% endif %}
    {{ calendar_form.url.label_tag }}
    {% render_field calendar_form.url class+='form-control'%}
    {% if calendar_form.url.errors %}
        <div class="form-errors">
            <div class="alert alert-danger">
                <div class="container">
                    <i class="fa fa-times"></i>{{ calendar_form.url.errors }}
                </div>
            </div>
        </div>
    {% endif %}
    {{ calendar_form.user.label_tag }}
    {% render_field calendar_form.user class+='form-control'%}
    {% if calendar_form.user.errors %}
        <div class="form-errors">
            <div class="alert alert-danger">
                <div class="container">
                    <i class="fa fa-times"></i>{{ calendar_form.user.errors }}
                </div>
            </div>
        </div>
    {% endif %}
    {{ calendar_form.password.label_tag }}
    {% render_field calendar_form.password class+='form-control'%}
    {% if calendar_form.password.errors %}
        <div class="form-errors">
            <div class="alert alert-danger">
                <div class="container">
                    <i class="fa fa-times"></i>{{ calendar_form.password.errors }}
                </div>
            </div>
        </div>
    {% endif %}
    <input type="submit" name="submit" value="{% trans 'Save' %}" class="action primary">
</form>
<form action="{% url 'change_calendar' %}" method="post">
{% csrf_token %}
<h3>Current Calendars:</h3>
<ul>
    {% for calendar in calendars %}
        <li>{{ calendar.name }}
            <button  name="delete" value="{{ calendar.id }}" class="btn btn-default btn-xs">
                <i class="fa fa-trash-o"></i>
            </button>
        </li>
    {% endfor %}
</ul>
</form>